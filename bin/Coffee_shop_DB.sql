CREATE DATABASE QUAN_CAFE_DATABASE;
GO

USE QUAN_CAFE_DATABASE;
GO

CREATE TABLE QUAN_CAFE (
	ID_QUAN NVARCHAR(10) PRIMARY KEY,
	TEN_QUAN NVARCHAR(255) NOT NULL,
	DIA_CHI NVARCHAR(255) NOT NULL);
GO

CREATE TABLE NHAN_VIEN (
	ID_NHAN_VIEN NVARCHAR(10) PRIMARY KEY,
	TEN_NHAN_VIEN NVARCHAR(255) NOT NULL,
	TUOI INT NOT NULL,
	DIA_CHI NVARCHAR(255) NOT NULL,
	SDT INT NOT NULL,
	LUONG FLOAT NOT NULL,
	ID_QUAN NVARCHAR(10),
	FOREIGN KEY (ID_QUAN) REFERENCES QUAN_CAFE(ID_QUAN),
);
GO

CREATE TABLE THUC_DON (
	ID_MON NVARCHAR(10) PRIMARY KEY,
	TEN_MON NVARCHAR(255) NOT NULL,
	GIA FLOAT NOT NULL,
	MO_TA NVARCHAR(255),
	ID_QUAN NVARCHAR(10),
	FOREIGN KEY (ID_QUAN) REFERENCES QUAN_CAFE(ID_QUAN),
);
GO

CREATE TABLE KHACH_HANG (
	ID_KHACH_HANG NVARCHAR(10) PRIMARY KEY,
	TEN_KHACH_HANG NVARCHAR(255) NOT NULL,
	SDT INT NOT NULL,
	ID_QUAN NVARCHAR(10),
	FOREIGN KEY (ID_QUAN) REFERENCES QUAN_CAFE(ID_QUAN),
);
GO


CREATE TABLE THANH_TOAN (
	ID_THANH_TOAN NVARCHAR(10) PRIMARY KEY,
	TONG_SO_TIEN FLOAT NOT NULL,
	PT_THANH_TOAN NVARCHAR(255) NOT NULL,
	NGAY_THANH_TOAN DATE NOT NULL,
	ID_KHACH_HANG NVARCHAR(10),
	FOREIGN KEY (ID_KHACH_HANG) REFERENCES KHACH_HANG(ID_KHACH_HANG),
);
GO


CREATE TABLE HOA_DON (
	ID_HOA_DON NVARCHAR(10) PRIMARY KEY,
	TONG_SO_TIEN FLOAT NOT NULL,
	ID_KHACH_HANG NVARCHAR(10),
	FOREIGN KEY (ID_KHACH_HANG) REFERENCES KHACH_HANG(ID_KHACH_HANG),
	ID_QUAN NVARCHAR(10),
	FOREIGN KEY (ID_QUAN) REFERENCES QUAN_CAFE(ID_QUAN),
);
GO

CREATE TABLE CHI_TIET_HOA_DON (
	ID_HOA_DON NVARCHAR(10),
	FOREIGN KEY (ID_HOA_DON) REFERENCES HOA_DON(ID_HOA_DON),
	TEN_MON NVARCHAR(255) NOT NULL,
	SO_LUONG INT NOT NULL,
	GIA FLOAT NOT NULL,
	ID_MON NVARCHAR(10),
	FOREIGN KEY (ID_MON) REFERENCES THUC_DON(ID_MON)
);
GO

ALTER TABLE THANH_TOAN
ADD ID_HOA_DON NVARCHAR(10);

ALTER TABLE THANH_TOAN
ADD CONSTRAINT ID_HOA_DON FOREIGN KEY (ID_HOA_DON) REFERENCES HOA_DON(ID_HOA_DON);

ALTER TABLE HOA_DON
ADD ID_THANH_TOAN NVARCHAR(10);

ALTER TABLE HOA_DON
ADD CONSTRAINT ID_THANH_TOAN FOREIGN KEY (ID_THANH_TOAN) REFERENCES THANH_TOAN(ID_THANH_TOAN);
